---
title: 线性分类
date: 2018-10-24 11:52:24
tags:
  - Machine Learning
  - CS231n
category: CS231n
---


## 介绍
&emsp;&emsp;接下来我们将会介绍线性分类的相关只是，对比于kNN算法，将会更加接近神经网络和卷积神经网络。该部分由两个部分构成：一部分将原始数据转化成相应分类分值的**评价函数**，另一部分是将预测的分值和真实值进行量化的**损失函数**。因此可以将问题转化成把损失函数最小化的优化问题。

## 从图片到标签分值的参数化映射
&emsp;&emsp;这个部分的主要方法是定义一个把图像中每个点的值转化成每个类别的置信得分的**评价函数**。我们假设一张训练图片\\(x_i\in R^D\\),其标签为\\(y_i\\)。 其中(\\( i = 1...N, y_i \in 1..K \\))，表明我们有**N**个训练图片，每张图片的维度为**D**，共有**K**个不同的分类。我们以**CIFAR-10**为例，训练集共有**N** = 50000张图片，每张图片的共有**D** = 32 x 32 x 3 = 3072个像素点，共有**K** = 10个分类。下面我们将会给出从原始图像的像素到分类得分的映射函数\\(f: R^D \mapsto R^K\\)：

**线性分类**，我们首先给出线性分类的简单函数：
$$ f(x_i, W, b) = Wx_i + b $$
在上面的等式中，我们假设图片\\(x_i\\)将所有的像素点展成一个单列的[D x 1]的向量。矩阵**W**(大小为K x D)，以及向量**b**(大小为[K x 1])作为函数的**参数**。应用到CIFAR-10的例子上，那么我们将会把第i张图片展成[3072 x 1]大小的单列向量，**W**大小为[10 x 3072]以及**b**的大小为[10 x 1]。因此将图像的原始像素输入到上述的函数中，那么将会输出10个数，作为分类的得分。参数**W**被称为**权重**，**b**被称为**偏差向量**(因为偏差影响最终的输出结果，但是跟图像的原始数据没有关系)。
这里有几点需要说明：
* 单一矩阵与\\(x_i\\)相乘的结果\\(Wx_i\\)能够并行的评估10个分类，每个分类的评估参数是**W**的一行。
* 输入数据\\((x_i, y_i)\\)是给定的并且是固定的，但是我们能够控制参数**W，b**。我们的目标是让训练数据计算得到的类的得分能够尽可能的和真实的标签相同。
* 这个方法的优点是可以使用训练数据去学习**W,b**，一旦学的参数，我们可以将学的参数保存起来，那么预测的时候只需要使用上述公式即可，只需要进行一次乘法和加法，计算是非常快的。
> 卷积神经网络也是类似的将图片的像素转成得分，但是映射的函数更为复杂并且包含更多的参数。

## 线性分类的解读
&emsp;&emsp;线性分类使用权重计算所有像素点的三个通道数值的和。依赖于精确的权重，函数能够挑选出在图片固定位置的一些颜色跟分类之间的联系。你可以想象船的周围是一些蓝色的，那么对于船的分类来说，在蓝色通道中会有很多正的权重，同样在红色或者绿色通道就会少一些。下图给出映射的一个例子：
{% asset_img imagemap.jpg %}

### 将图像类比于高维的点
由于图片被拉伸成高维的列向量，我们可以将每张图片看成空间中的一个点，(例如CIFAR-10中的每张32 x 32 x 3像素的图片看成3072维上的一个点)。那么整个数据集就可以看成是一系列的点。介于我们为每个分为定义计算图片像素上权重的和的得分，每个分类的得分在空间上都是一个线性函数。我们无法直观的可视化3072维的空间，但是如果将这些维度挤压成2维的，那么就能尝试的可视化分类了，可视化的结果如下：
{% asset_img pixelspace.jpg %}
> 正如上图，每张图片看成是空间上的一个点，这里可视化了3个分类。红色的是车的类别，红色的先表示在车的分类上得分为0，红色的箭头表示得分的增加的方向，因此所有在红线的右侧能够得到正数的得分，左侧会得到负数的得分。